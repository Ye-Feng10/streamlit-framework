import streamlit as stimport pandas as pdimport requestsfrom bokeh.plotting import figurefrom dotenv import load_dotenvimport osload_dotenv()API_KEY = os.getenv("API_KEY")st.title('Stock Price Dashboard')symbol = st.sidebar.text_input("Ticker (e.g. AAPL):", value="AAPL", max_chars=None)r = requests.get(f"https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol={symbol}&outputsize=full&apikey={API_KEY}")data = r.json()# convert data to pandas dataframe_, header = r.json()df = pd.DataFrame.from_dict(data[header], orient='index')# clean up column names and create year, month variablesdf.columns = [i.split(' ')[1] for i in df.columns]df['date'] = df.indexdf['date'] = pd.to_datetime(df['date'])df['year'] = df['date'].dt.yeardf['month'] = df['date'].dt.month_name()year = st.sidebar.selectbox('Year',(2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021))month = st.sidebar.selectbox('Month',('January','February','March','April','May','June','July','August','September','October','November','December'))# subset datadf1 = df[(df.year == year) & (df.month == month)]# create plotp = figure(title="Closing price", x_axis_type="datetime",x_axis_label='date', y_axis_label='close')p.line(df1['date'], df1['close'], legend_label="{}".format(symbol), line_width=2)# show table and plotst.bokeh_chart(p, use_container_width=True)df1.drop('date', axis=1, inplace=True)  st.dataframe(df1)